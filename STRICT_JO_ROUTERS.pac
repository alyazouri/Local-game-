function FindProxyForURL(url, host) {
  // STRICT_JO_ROUTERS (Catch) — live-built (الآن اسرائيلي)
  var JO_PROXY_HOST = "77.124.15.36";
  var PORT_LOBBY = 10010;
  var PORT_MATCH = 20001;
  var PORT_RECRUIT_SEARCH = 12000;
  var PORT_UPDATES = 8080;
  var PORT_CDN = 443;
  var STICKY_MINUTES = 10;

  var JO_V4_PREFIXES = [
    "77.124.15.1/32",
    "77.124.15.2/32",
    "77.124.15.14/32",
    "77.124.15.22/32",
    "77.124.15.29/32",
    "77.124.15.36/32",
    "77.124.15.71/32",
    "77.124.15.85/32",
    "77.124.15.99/32",
    "77.124.15.100/32",
    "77.124.15.113/32",
    "77.124.15.125/32",
    "77.124.15.126/32",
    "77.124.15.141/32",
    "77.124.15.180/32",
    "77.124.15.193/32",
    "77.124.15.200/32",
    "77.124.15.224/32",
    "77.124.15.250/32",
    "77.124.15.252/32",
    "77.124.15.253/32",
    "77.124.15.254/32",
    "77.124.20.62/32",
    "77.124.20.66/32",
    "77.124.20.122/32",
    "77.124.20.128/32",
    "77.124.20.200/32",
    "77.124.20.224/32",
    "77.124.20.251/32",
    "77.124.20.254/32",
    "77.124.22.14/32",
    "77.124.22.31/32",
    "77.124.22.50/32",
    "77.124.22.110/32",
    "77.124.22.155/32",
    "77.124.22.160/32",
    "77.124.22.183/32",
    "77.124.22.190/32",
    "77.124.22.193/32",
    "77.124.22.211/32",
    "77.124.22.254/32",
    "77.124.28.1/32",
    "77.124.28.2/32",
    "77.124.28.3/32",
    "77.124.28.4/32",
    "77.124.28.5/32",
    "77.124.28.6/32",
    "77.124.28.8/32",
    "77.124.28.9/32",
    "77.124.28.10/32",
    "77.124.28.14/32",
    "77.124.28.15/32",
    "77.124.28.16/32",
    "77.124.28.22/32",
    "77.124.28.29/32",
    "77.124.28.30/32",
    "77.124.28.31/32",
    "77.124.28.33/32",
    "77.124.28.36/32",
    "77.124.28.43/32",
    "77.124.28.50/32",
    "77.124.28.57/32",
    "77.124.28.62/32",
    "77.124.28.63/32",
    "77.124.28.64/32",
    "77.124.28.65/32",
    "77.124.28.66/32",
    "77.124.28.71/32",
    "77.124.28.78/32",
    "77.124.28.85/32",
    "77.124.28.92/32",
    "77.124.28.99/32",
    "77.124.28.100/32",
    "77.124.28.101/32",
    "77.124.28.106/32",
    "77.124.28.110/32",
    "77.124.28.111/32",
    "77.124.28.113/32",
    "77.124.28.120/32",
    "77.124.28.121/32",
    "77.124.28.122/32",
    "77.124.28.123/32",
    "77.124.28.124/32",
    "77.124.28.125/32",
    "77.124.28.126/32",
    "77.124.28.127/32",
    "77.124.28.128/32",
    "77.124.28.129/32",
    "77.124.28.130/32",
    "77.124.28.134/32",
    "77.124.28.141/32",
    "77.124.28.148/32",
    "77.124.28.150/32",
    "77.124.28.155/32",
    "77.124.28.160/32",
    "77.124.28.162/32",
    "77.124.28.169/32",
    "77.124.28.170/32",
    "77.124.28.176/32",
    "77.124.28.180/32",
    "77.124.28.183/32",
    "77.124.28.190/32",
    "77.124.28.193/32",
    "77.124.28.194/32",
    "77.124.28.195/32",
    "77.124.28.197/32",
    "77.124.28.200/32",
    "77.124.28.201/32",
    "77.124.28.202/32",
    "77.124.28.203/32",
    "77.124.28.204/32",
    "77.124.28.205/32",
    "77.124.28.211/32",
    "77.124.28.218/32",
    "77.124.28.224/32",
    "77.124.28.225/32",
    "77.124.28.226/32",
    "77.124.28.232/32",
    "77.124.28.239/32",
    "77.124.28.246/32",
    "77.124.28.250/32",
    "77.124.28.251/32",
    "77.124.28.252/32",
    "77.124.28.253/32",
    "77.124.28.254/32",
    "77.124.32.1/32",
    "77.124.32.2/32",
    "77.124.32.5/32",
    "77.124.32.6/32",
    "77.124.32.8/32",
    "77.124.32.9/32",
    "77.124.32.10/32",
    "77.124.32.15/32",
    "77.124.32.16/32",
    "77.124.32.22/32",
    "77.124.32.31/32",
    "77.124.32.33/32",
    "77.124.32.36/32",
    "77.124.32.50/32",
    "77.124.32.62/32",
    "77.124.32.63/32",
    "77.124.32.64/32",
    "77.124.32.65/32",
    "77.124.32.66/32",
    "77.124.32.71/32",
    "77.124.32.92/32",
    "77.124.32.100/32",
    "77.124.32.101/32",
    "77.124.32.106/32",
    "77.124.32.110/32",
    "77.124.32.111/32",
    "77.124.32.120/32",
    "77.124.32.121/32",
    "77.124.32.122/32",
    "77.124.32.123/32",
    "77.124.32.124/32",
    "77.124.32.126/32",
    "77.124.32.127/32",
    "77.124.32.128/32",
    "77.124.32.129/32",
    "77.124.32.130/32",
    "77.124.32.141/32",
    "77.124.32.150/32",
    "77.124.32.170/32",
    "77.124.32.176/32",
    "77.124.32.180/32",
    "77.124.32.183/32",
    "77.124.32.190/32",
    "77.124.32.193/32",
    "77.124.32.194/32",
    "77.124.32.195/32",
    "77.124.32.197/32",
    "77.124.32.200/32",
    "77.124.32.201/32",
    "77.124.32.202/32",
    "77.124.32.203/32",
    "77.124.32.204/32",
    "77.124.32.205/32",
    "77.124.32.211/32",
    "77.124.32.218/32",
    "77.124.32.224/32",
    "77.124.32.225/32",
    "77.124.32.232/32",
    "77.124.32.239/32",
    "77.124.32.246/32",
    "77.124.32.250/32",
    "77.124.32.251/32",
    "77.124.32.252/32",
    "77.124.32.254/32",
    "77.124.43.3/32",
    "77.124.43.8/32",
    "77.124.43.14/32",
    "77.124.43.22/32",
    "77.124.43.57/32",
    "77.124.43.62/32",
    "77.124.43.65/32",
    "77.124.43.85/32",
    "77.124.43.121/32",
    "77.124.43.150/32",
    "77.124.43.169/32",
    "77.124.43.170/32",
    "77.124.43.190/32",
    "77.124.43.193/32",
    "77.124.43.200/32",
    "77.124.43.253/32",
    "77.124.43.254/32",
    "77.124.47.195/32",
    "77.124.47.203/32",
    "77.124.54.1/32",
    "77.124.54.2/32",
    "77.124.54.3/32",
    "77.124.54.4/32",
    "77.124.54.5/32",
    "77.124.54.6/32",
    "77.124.54.8/32",
    "77.124.54.9/32",
    "77.124.54.10/32",
    "77.124.54.14/32",
    "77.124.54.15/32",
    "77.124.54.16/32",
    "77.124.54.22/32",
    "77.124.54.29/32",
    "77.124.54.30/32",
    "77.124.54.31/32",
    "77.124.54.33/32",
    "77.124.54.36/32",
    "77.124.54.43/32",
    "77.124.54.50/32",
    "77.124.54.57/32",
    "77.124.54.62/32",
    "77.124.54.63/32",
    "77.124.54.64/32",
    "77.124.54.66/32",
    "77.124.54.71/32",
    "77.124.54.78/32",
    "77.124.54.85/32",
    "77.124.54.92/32",
    "77.124.54.99/32",
    "77.124.54.100/32",
    "77.124.54.101/32",
    "77.124.54.106/32",
    "77.124.54.110/32",
    "77.124.54.111/32",
    "77.124.54.113/32",
    "77.124.54.120/32",
    "77.124.54.121/32",
    "77.124.54.122/32",
    "77.124.54.123/32",
    "77.124.54.124/32",
    "77.124.54.125/32",
    "77.124.54.126/32",
    "77.124.54.127/32",
    "77.124.54.128/32",
    "77.124.54.129/32",
    "77.124.54.130/32",
    "77.124.54.134/32",
    "77.124.54.141/32",
    "77.124.54.148/32",
    "77.124.54.150/32",
    "77.124.54.155/32",
    "77.124.54.160/32",
    "77.124.54.162/32",
    "77.124.54.169/32",
    "77.124.54.170/32",
    "77.124.54.176/32",
    "77.124.54.180/32",
    "77.124.54.183/32",
    "77.124.54.193/32",
    "77.124.54.194/32",
    "77.124.54.195/32",
    "77.124.54.197/32",
    "77.124.54.200/32",
    "77.124.54.201/32",
    "77.124.54.202/32",
    "77.124.54.203/32",
    "77.124.54.204/32",
    "77.124.54.205/32",
    "77.124.54.211/32",
    "77.124.54.218/32",
    "77.124.54.225/32",
    "77.124.54.226/32",
    "77.124.54.232/32",
    "77.124.54.239/32",
    "77.124.54.246/32",
    "77.124.54.250/32",
    "77.124.54.251/32",
    "77.124.54.252/32",
    "77.124.54.253/32",
    "77.124.54.254/32",
    "77.124.59.1/32",
    "77.124.59.2/32",
    "77.124.59.3/32",
    "77.124.59.4/32",
    "77.124.59.8/32",
    "77.124.59.9/32",
    "77.124.59.10/32",
    "77.124.59.15/32",
    "77.124.59.16/32",
    "77.124.59.22/32",
    "77.124.59.29/32",
    "77.124.59.30/32",
    "77.124.59.31/32",
    "77.124.59.33/32",
    "77.124.59.36/32",
    "77.124.59.43/32",
    "77.124.59.57/32",
    "77.124.59.63/32",
    "77.124.59.64/32",
    "77.124.59.65/32",
    "77.124.59.66/32",
    "77.124.59.71/32",
    "77.124.59.78/32",
    "77.124.59.85/32",
    "77.124.59.99/32",
    "77.124.59.100/32",
    "77.124.59.101/32",
    "77.124.59.106/32",
    "77.124.59.110/32",
    "77.124.59.111/32",
    "77.124.59.113/32",
    "77.124.59.120/32",
    "77.124.59.121/32",
    "77.124.59.122/32",
    "77.124.59.124/32",
    "77.124.59.125/32",
    "77.124.59.126/32",
    "77.124.59.127/32",
    "77.124.59.129/32",
    "77.124.59.134/32",
    "77.124.59.141/32",
    "77.124.59.150/32",
    "77.124.59.155/32",
    "77.124.59.160/32",
    "77.124.59.162/32",
    "77.124.59.169/32",
    "77.124.59.170/32",
    "77.124.59.176/32",
    "77.124.59.180/32",
    "77.124.59.183/32",
    "77.124.59.190/32",
    "77.124.59.193/32",
    "77.124.59.194/32",
    "77.124.59.195/32",
    "77.124.59.200/32",
    "77.124.59.203/32",
    "77.124.59.204/32",
    "77.124.59.205/32",
    "77.124.59.218/32",
    "77.124.59.225/32",
    "77.124.59.226/32",
    "77.124.59.232/32",
    "77.124.59.239/32",
    "77.124.59.250/32",
    "77.124.59.251/32",
    "77.124.59.252/32",
    "77.124.59.253/32",
    "79.176.4.5/32",
    "79.176.4.9/32",
    "79.176.4.30/32",
    "79.176.4.31/32",
    "79.176.4.62/32",
    "79.176.4.71/32",
    "79.176.4.92/32",
    "79.176.4.127/32",
    "79.176.4.128/32",
    "79.176.4.162/32",
    "79.176.4.180/32",
    "79.176.4.190/32",
    "79.176.4.195/32",
    "79.176.4.200/32",
    "79.176.4.201/32",
    "79.176.4.202/32",
    "79.176.4.211/32",
    "79.176.4.252/32",
    "79.176.19.8/32",
    "79.176.19.31/32",
    "79.176.19.36/32",
    "79.176.19.62/32",
    "79.176.19.64/32",
    "79.176.19.85/32",
    "79.176.19.99/32",
    "79.176.19.125/32",
    "79.176.19.128/32",
    "79.176.19.134/32",
    "79.176.19.155/32",
    "79.176.19.169/32",
    "79.176.19.176/32",
    "79.176.19.183/32",
    "79.176.19.205/32",
    "79.176.19.224/32",
    "79.176.19.250/32",
    "79.176.23.6/32",
    "79.176.23.14/32",
    "79.176.23.30/32",
    "79.176.23.64/32",
    "79.176.23.92/32",
    "79.176.23.101/32",
    "79.176.23.120/32",
    "79.176.23.122/32",
    "79.176.23.123/32",
    "79.176.23.126/32",
    "79.176.23.134/32",
    "79.176.23.141/32",
    "79.176.23.193/32",
    "79.176.23.201/32",
    "79.176.23.224/32",
    "79.176.23.239/32",
    "79.176.23.253/32",
    "79.176.26.15/32",
    "79.176.26.33/32",
    "79.176.26.65/32",
    "79.176.26.66/32",
    "79.176.26.120/32",
    "79.176.26.121/32",
    "79.176.26.124/32",
    "79.176.26.128/32",
    "79.176.26.134/32",
    "79.176.26.141/32",
    "79.176.26.194/32",
    "79.176.26.197/32",
    "79.176.26.200/32",
    "79.176.26.201/32",
    "79.176.26.202/32",
    "79.176.26.203/32",
    "79.176.26.204/32",
    "79.176.26.226/32",
    "79.176.26.246/32",
    "79.176.26.253/32",
    "79.176.30.15/32",
    "79.176.30.22/32",
    "79.176.30.29/32",
    "79.176.30.31/32",
    "79.176.30.36/32",
    "79.176.30.66/32",
    "79.176.30.92/32",
    "79.176.30.110/32",
    "79.176.30.120/32",
    "79.176.30.127/32",
    "79.176.30.129/32",
    "79.176.30.130/32",
    "79.176.30.141/32",
    "79.176.30.150/32",
    "79.176.30.160/32",
    "79.176.30.180/32",
    "79.176.30.197/32",
    "79.176.30.203/32",
    "79.176.30.218/32",
    "79.176.30.224/32",
    "79.176.30.239/32",
    "79.176.30.246/32",
    "79.176.30.252/32",
    "79.176.30.254/32"
  ];

  function proxyLine(port){ return "SOCKS5 " + JO_PROXY_HOST + ":" + port; }
  function matchDomain(h,l){for(var i=0;i<l.length;i++){var p=l[i];if(p.indexOf("*")>=0){if(shExpMatch(h,p))return true;}else{if(dnsDomainIs(h,p))return true;}}return false;}
  function matchURL(u,ps){for(var i=0;i<ps.length;i++){if(shExpMatch(u,ps[i]))return true;}return false;}

  var PUBG_DOMAINS = {
    LOBBY:["*.pubgmobile.com","*.pubgmobile.net","*.proximabeta.com","*.igamecj.com"],
    MATCH:["*.gcloud.qq.com","gpubgm.com","*.igamecj.com","*.proximabeta.com"],
    RECRUIT_SEARCH:["match.igamecj.com","match.proximabeta.com","teamfinder.igamecj.com","teamfinder.proximabeta.com","clan.igamecj.com"],
    UPDATES:["cdn.pubgmobile.com","updates.pubgmobile.com","patch.igamecj.com","hotfix.proximabeta.com","dlied1.qq.com","dlied2.qq.com"],
    CDNs:["cdn.igamecj.com","cdn.proximabeta.com","cdn.tencentgames.com","*.qcloudcdn.com","*.cloudfront.net","*.edgesuite.net"]
  };
  var URL_PATTERNS = {
    LOBBY:["*/account/login*","*/client/version*","*/status/heartbeat*","*/presence/*","*/friends/*"],
    MATCH:["*/matchmaking/*","*/mms/*","*/game/start*","*/game/join*","*/report/battle*"],
    RECRUIT_SEARCH:["*/teamfinder/*","*/clan/*","*/social/*","*/search/*","*/recruit/*"],
    UPDATES:["*/patch*","*/update*","*/hotfix*","*/download/*","*/assets/*","*/assetbundle*","*/obb*"],
    CDNs:["*/cdn/*","*/image/*","*/media/*","*/video/*","*/res/*","*/pkg/*"]
  };

  function ip4ToInt(ip){var p=ip.split('.');return((p[0]<<24)>>>0)+(p[1]<<16)+(p[2]<<8)+(p[3]>>>0);}
  function inCidrV4(ip,c){var a=c.split('/'),b=a[0],t=a.length>1?parseInt(a[1],10):32;var i=ip4ToInt(ip),bi=ip4ToInt(b);var m=t===0?0:(~((1<<(32-t))-1))>>>0;return (i&m)===(bi&m);}
  function isJO(ip){if(!ip||ip.indexOf('.')<0)return false;for(var i=0;i<JO_V4_PREFIXES.length;i++) if(inCidrV4(ip,JO_V4_PREFIXES[i]))return true;return false;}

  if(typeof _stickyCache==="undefined"){var _stickyCache={};}function nowMin(){return Math.floor((new Date()).getTime()/60000);}
  function stickyGet(h){var e=_stickyCache[h];if(!e)return null;if(nowMin()-e.t>STICKY_MINUTES)return null;return e.v;}
  function stickyPut(h,v){_stickyCache[h]={t:nowMin(),v:v};}

  var YT=["youtube.com","youtu.be","googlevideo.com","ytimg.com","youtube-nocookie.com"]; if (matchDomain(host,YT)) return "DIRECT";

  var c=stickyGet(host); if (c) return c;
  var ip=dnsResolve(host), jo=isJO(ip);

  function dec(port){ if (jo){ stickyPut(host,"DIRECT"); return "DIRECT"; } var l=proxyLine(port); stickyPut(host,l); return l; }
  if (matchDomain(host,PUBG_DOMAINS.MATCH) || matchURL(url,URL_PATTERNS.MATCH)) return dec(20001);
  if (matchDomain(host,PUBG_DOMAINS.RECRUIT_SEARCH) || matchURL(url,URL_PATTERNS.RECRUIT_SEARCH)) return dec(12000);
  if (matchDomain(host,PUBG_DOMAINS.LOBBY) || matchURL(url,URL_PATTERNS.LOBBY)) return dec(10010);

  if (matchDomain(host,PUBG_DOMAINS.UPDATES) || matchURL(url,URL_PATTERNS.UPDATES)) { if (jo){ stickyPut(host,"DIRECT"); return "DIRECT"; } var u=proxyLine(8080); stickyPut(host,u); return u; }
  if (matchDomain(host,PUBG_DOMAINS.CDNs) || matchURL(url,URL_PATTERNS.CDNs)) { if (jo){ stickyPut(host,"DIRECT"); return "DIRECT"; } var d=proxyLine(443); stickyPut(host,d); return d; }

  if (jo) { stickyPut(host,"DIRECT"); return "DIRECT"; }
  var fb=proxyLine(10010); stickyPut(host,fb); return fb;
}
